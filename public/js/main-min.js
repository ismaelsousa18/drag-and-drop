var previousPos,holdMouseClick,grabbedCard,defaultList,isGrabbed=!1,cardsSelector=".card-list-container ul.card-list >.content li.card",possibleDropList=$("ul.card-list > .content"),mousex=0,mousey=0;function onLimitsX(){var e=parseInt($(cardsSelector).css("width"))/2;return!(mousex-e<0||mousex+e>window.innerWidth)}function onLimitsY(){var e=parseInt($(cardsSelector).css("height"))/2;return!(mousey-e<0||mousey+e>window.innerHeight-20)}function verifDrop(){organizeList(verifList())}function verifList(){var e;return $(possibleDropList).each((s,r)=>{$(r).offset().left<mousex&&(e=$(r))}),null==e&&(e=$(possibleDropList)[0]),e}function verifPos(e){var s=$(e).find(".card:not(.isgrabbed)"),r=parseInt($(s).css("height"))/2,o=[],a=!1;return $(s).each((e,s)=>{$(s).offset().top+r<mousey?o.push(s):a?o.push(s):(o.push(grabbedCard),o.push(s),a=!0)}),a||o.push(grabbedCard),o}function organizeList(e,s=!1){e=e[0];var r=!1,o=100;if(s&&(o=0),e!=defaultList[0]){var a=verifPos(defaultList[0]);$(a).each((e,s)=>{s!=grabbedCard&&$(s).animate({top:""},o)}),defaultList[0]=e,r=!0}var t=verifPos(verifList());if(previousPos!=t.indexOf(grabbedCard)||r){previousPos=t.indexOf(grabbedCard);var i=$(".card-list-container .card-list > .content").offset().top;$(t).each((e,s)=>{if(e<t.indexOf(grabbedCard))i+=parseInt($(s).css("height"))+parseInt($(s).css("margin-bottom")),$(s).animate({top:""},o);else if(e==t.indexOf(grabbedCard))$(s).animate({top:`${i}px`},o);else{var r=parseInt($(grabbedCard).css("height"))+parseInt($(grabbedCard).css("margin-bottom"));$(s).animate({top:`${r}px`},o)}})}$(e).html(""),$(t).each((s,r)=>{$(e).append(r)})}function createClone(e,s){mousex=e.clientX,mousey=e.clientY;var r=s[0].cloneNode(!0);$(r).addClass("clone"),$(r).css("position","absolute");var o=mousex-parseInt($(s).css("width"))/2,a=mousey-parseInt($(s).css("height"))/2;return $(r).css("left",`${o}px`),$(r).css("top",`${a}px`),r}function removeClone(){$("body").find(".card.clone").remove()}function moveClone(e){mousex=e.clientX,mousey=e.clientY;var s=$("body").find(".card.clone"),r=mousex-parseInt($(s).css("width"))/2,o=mousey-parseInt($(s).css("height"))/2;onLimitsX()&&$(s).css("left",r),onLimitsY()&&$(s).css("top",o),verifDrop()}function grabCard(e,s){if(!isGrabbed){mousex=e.clientX,mousey=e.cientY,defaultList=$(s).closest(".content"),isGrabbed=!0;var r=createClone(e,s);$(r).addClass("clone"),$(s).addClass("isgrabbed"),grabbedCard=s,$(".card-list-container").append(r),organizeList(defaultList,!0)}}function dropCard(){$(grabbedCard).removeClass("isgrabbed"),$(defaultList).find(".card").each((e,s)=>{$(s).css("top","")})}function clickCard(e){$(".clicked").removeClass("clicked"),$(e).addClass("clicked")}$(document).on("mousedown",cardsSelector,e=>{var s=$(e.target).closest(".card");holdMouseClick=setTimeout(()=>{clearTimeout(holdMouseClick),grabCard(e,s)},200),$(e.target).on("mouseleave",e=>{isGrabbed&&(clearTimeout(holdMouseClick),grabCard(e,s))})}),$(document).on("mousemove",e=>{isGrabbed&&moveClone(e)}),$(document).on("mouseup",e=>{clearTimeout(holdMouseClick);var s=$(e.target).closest(".card"),r=$(cardsSelector).toArray().some(e=>e==s[0]);isGrabbed?dropCard():r&&clickCard(s),removeClone(),isGrabbed=!1}),$(document).ready(function(){feather.replace()});